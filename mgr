#!/bin/bash

# Colors
BLACK='\033[1;30m'        # Black
RED='\033[1;31m'          # Red
GREEN='\033[1;32m'        # Green
YELLOW='\033[1;33m'       # Yellow
BLUE='\033[1;34m'         # Blue
CYAN='\033[1;36m'         # Cyan
WHITE='\033[1;37m'        # White
LIGHT_GREEN='\033[0;32m'  # Light Green


automatic_git () {
  {
      COMMAND=$("git add . && git commit -m "Automatic commit via mgr command" && git push")
  }
  CMD_RETURN_CODE=$?

  echo -e "${YELLOW} --- Push changes to git repo ---"
    if [ $CMD_RETURN_CODE != 0 ]; then
        echo -e "${RED}"
        git add . && git commit -m "Automatic commit via mgr command" && git push
    else
      echo -e "${GREEN}"
      git add . && git commit -m "$1" && git push
    fi
  echo -e "${WHITE}"
}

usage="$(basename "$0") [-h] [-g] -- script that automates stuff

where:
    -h  show this help text
    -g  [mgr -g 'commit message'] Will add,commit, and push to Git in the current directory."

while getopts ':hg:' option; do
  case "$option" in
    h) echo "$usage"
       exit
       ;;
    :) echo "missing argument for -%s\n" "$OPTARG" >&2
       echo "$usage" >&2
       exit 1
       ;;
    g) automatic_git $2
       ;;
   \?) echo "illegal option: -%s\n" "$OPTARG" >&2
       echo "$usage" >&2
       exit 1
       ;;
  esac
done

